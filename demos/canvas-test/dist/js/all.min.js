function draw(){ctx.clearRect(0,0,width,height),ctx.beginPath(),ctx.fillStyle="#eee",ctx.fillRect(0,0,width,height),ctx.font=fontSize+"px Microsoft YaHei",text=parseInt(i/total*100)+"%",measureText=ctx.measureText(text),ctx.fillStyle="#ccc",ctx.fillText(text,x-measureText.width/2,y+fontSize/4),ctx.strokeStyle="#000",ctx.arc(x,y,r,startAngle,endAngle,!1),ctx.lineWidth=lineWidth,ctx.stroke(),angle=startAngle+2*pi*i/100,ctx.beginPath(),ctx.strokeStyle="#f00",ctx.lineWidth=lineWidth,ctx.lineCap="round",ctx.arc(x,y,r,startAngle,angle,!1),ctx.stroke(),ani=window.requestAnimationFrame(draw),++i>value&&window.cancelAnimationFrame(ani)}var demo=document.getElementById("demo"),ctx=demo.getContext("2d"),zoomctx=document.getElementById("zoom").getContext("2d"),pi=Math.PI,lineWidth=20,startAngle=pi/-2,endAngle=3*pi/2,total=100,value=80,width=demo.width,height=demo.height,x=width/2,y=height/2,r=Math.min(x,y)-lineWidth,fontSize=100,i=0,ani,angle,text,measureText;draw(),zoomctx.imageSmoothingEnabled=!0,zoomctx.mozImageSmoothingEnabled=!0,zoomctx.webkitImageSmoothingEnabled=!0,zoomctx.msImageSmoothingEnabled=!0;var zoom=function(t){var e=t.layerX,o=t.layerY;zoomctx.drawImage(demo,e-50,o-50,100,100,0,0,300,300)};demo.addEventListener("mousemove",zoom),demo.addEventListener("mouseout",function(){zoomctx.clearRect(0,0,300,300)});